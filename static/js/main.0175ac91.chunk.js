(this["webpackJsonpwhatsapp-clone-stajan5"]=this["webpackJsonpwhatsapp-clone-stajan5"]||[]).push([[0],{69:function(e,t,a){},70:function(e,t,a){},76:function(e,t,a){},78:function(e,t,a){},80:function(e,t,a){},82:function(e,t,a){},84:function(e,t,a){"use strict";a.r(t);var c=a(4),n=a(2),s=a.n(n),o=a(28),i=a.n(o),r=(a(69),a(70),a(24)),l=a(101),d=a(58),u=a.n(d),h=a(31),j=a(11),b=a(43),m=Object(b.b)({name:"user",initialState:{username:null,photourl:"",email:"",uid:"",chatWithPersonEmail:"",chatWithPersonPhotoUrl:""},reducers:{setUsername:function(e,t){e.username=t.payload.userdetails,e.photourl=t.payload.photourl,e.email=t.payload.email,e.uid=t.payload.uid},logout:function(e){e.username=null,e.photourl=null,e.email=null,e.uid=null},userWithWhomToChat:function(e,t){e.chatWithPersonEmail=t.payload.chatWithPersonEmail,e.chatWithPersonPhotoUrl=t.payload.chatWithPersonPhotoUrl}}}),p=m.actions,O=p.setUsername,f=p.logout,v=p.userWithWhomToChat,x=function(e){return e.user.username},g=function(e){return e.user.photourl},N=function(e){return e.user.email},w=function(e){return e.user.uid},y=function(e){return e.user.chatWithPersonEmail},S=function(e){return e.user.chatWithPersonPhotoUrl},_=m.reducer,W=a(23);a(76);var k=function(e){var t=e.id,a=e.name,n=e.photoURL,s=e.uidConcatenation,o=e.email,i=Object(j.b)();return W.a.auth().onAuthStateChanged((function(e){e&&i(v({chatWithPersonEmail:o,chatWithPersonPhotoUrl:n}))})),Object(c.jsx)("div",{onClick:function(){i(v({chatWithPersonEmail:o,chatWithPersonPhotoUrl:n}))},children:Object(c.jsx)(h.c,{to:"/rooms/".concat(s),children:Object(c.jsxs)("div",{className:"start_chat",children:[Object(c.jsx)("div",{className:"Avatar",children:Object(c.jsx)(l.a,{className:"avatarHover",src:n||"https://avatars.dicebear.com/api/human/".concat(t,".svg")})}),Object(c.jsxs)("div",{className:"start_chat_name_last_message",children:[Object(c.jsx)("p",{className:"Name",children:a}),Object(c.jsx)("p",{children:"Last Message...."})]})]})})})},P=W.a.initializeApp({apiKey:"AIzaSyDNzyBhtO2hKRKNHJQxX6JK33eexKfsMsE",authDomain:"chatbox-b45e3.firebaseapp.com",projectId:"chatbox-b45e3",storageBucket:"chatbox-b45e3.appspot.com",messagingSenderId:"609218165702",appId:"1:609218165702:web:4d13cefd0590ec6acf90c7",measurementId:"G-R3HVEQ7CLG"}).firestore(),C=W.a.auth(),U=new W.a.auth.GoogleAuthProvider,E=P;a(78);var L=function(){var e=Object(n.useState)([]),t=Object(r.a)(e,2),a=t[0],s=t[1],o=Object(j.c)(x),i=Object(j.c)(N),d=Object(j.c)(g),h=Object(j.c)(w);return Object(n.useEffect)((function(){E.collection("rooms").orderBy("timestamp","desc").onSnapshot((function(e){return s(e.docs.map((function(e){return{id:e.id,data:e.data()}})))}))}),[]),console.log("rooms,",a),Object(c.jsxs)("div",{className:"sidebar",children:[Object(c.jsxs)("div",{className:"sidebar_header ",children:[Object(c.jsx)(l.a,{src:d}),Object(c.jsxs)("div",{className:"sidebar_header_middle",children:[Object(c.jsx)("h3",{children:o}),Object(c.jsxs)("p",{children:["Signed in as ",Object(c.jsxs)("strong",{children:[" ",i]})]})]})]}),Object(c.jsxs)("div",{className:"sidebar_search",children:[Object(c.jsx)(u.a,{}),Object(c.jsx)("input",{className:"input",type:"text",placeholder:"Search or start new chat"})]}),Object(c.jsx)("div",{onClick:function(){var e=prompt("New room name?");e&&E.collection("rooms").add({personName:e,timestamp:W.a.firestore.FieldValue.serverTimestamp()})},className:"new_chat",children:Object(c.jsx)("h3",{style:{fontSize:"14px",cursor:"pointer"},className:"addChat",children:"Add New Chat"})}),Object(c.jsx)("div",{className:"sidebar_scroll",children:Object(c.jsx)("div",{className:"sidebar_chat",children:a.map((function(e){var t,a,n;return Object(c.jsxs)("div",{className:"classRoom",children:[Object(c.jsx)(k,{id:e.id,name:e.data.personName,photoURL:e.data.photoURL,uidConcatenation:(null===e||void 0===e||null===(t=e.data)||void 0===t?void 0:t.uid)<h?(null===e||void 0===e||null===(a=e.data)||void 0===a?void 0:a.uid)+h:h+(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.uid),email:e.data.personName},e.id),Object(c.jsxs)("p",{className:"personNameInSmallGroup",children:[" ",e.data.personName]}),Object(c.jsx)("hr",{className:"hrGroup"})]},e.id)}))})})]})},R=a(59),A=a.n(R),I=a(10),D=a(60),T=a.n(D);a(80);var z=function(){var e=Object(n.useState)(""),t=Object(r.a)(e,2),a=t[0],s=t[1],o=Object(n.useState)([]),i=Object(r.a)(o,2),d=i[0],u=i[1],h=Object(n.useState)(""),b=Object(r.a)(h,2),m=b[0],p=b[1],O=Object(n.useState)([]),v=Object(r.a)(O,2),x=v[0],g=v[1],_=Object(j.c)(N),k=(Object(j.c)(w),Object(j.c)(y)),P=Object(j.c)(S),C=Object(I.f)().id,U=Object(I.e)(),L=Object(j.b)();Object(n.useEffect)((function(){p(P),u(k)}),[C,k]);var R=Object(n.useState)(!1),D=Object(r.a)(R,2),z=D[0],B=D[1],G=Object(n.useState)([]),H=Object(r.a)(G,2),K=H[0];H[1],Object(n.useEffect)((function(){E.collection("messages").doc(C).collection("messages").orderBy("timestamp","asc").onSnapshot((function(e){console.log("Current data: ",e.docs),g(e.docs.map((function(e){return e.data()})))}))}),[C]),console.log("msgs",K);var J=function(e){e.preventDefault(),L(f()),W.a.auth().signOut().then((function(e){U.push("/")})).catch((function(e){console.log(e)}))};return Object(n.useEffect)((function(){var e=document.querySelector("#scrollDiv");e.scrollTop=(null===e||void 0===e?void 0:e.scrollHeight)-(null===e||void 0===e?void 0:e.clientHeight)}),[x]),Object(c.jsxs)("div",{className:"chatbox",children:[d?Object(c.jsxs)("div",{className:"chatbox_header",children:[Object(c.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(c.jsx)("div",{className:"chatbox_header_avatar",children:Object(c.jsx)(l.a,{src:m})}),Object(c.jsxs)("div",{className:"chatbox_header_details",children:[Object(c.jsx)("h3",{children:d}),Object(c.jsx)("p",{children:"Last Seen At..."})]})]}),Object(c.jsxs)("div",{className:"exit_icon",style:{marginRight:"15px",cursor:"pointer"},onClick:J,children:[Object(c.jsx)("div",{className:"",children:Object(c.jsx)(A.a,{onClick:J})}),Object(c.jsx)("p",{children:"LogOut"})]})]}):Object(c.jsx)("div",{style:{height:"10%"}}),Object(c.jsx)("div",{id:"scrollDiv",className:"message_scroll",children:x.map((function(e){return Object(c.jsx)("p",{className:"chatbox_message_sender ".concat(_===e.name&&"chatbox_message_receiver"),children:e.message},e.message)}))}),Object(c.jsx)("div",{className:"chatbox_footer",children:Object(c.jsxs)("form",{className:"chatbox_footer_form",style:{fontSize:"22px"},children:[Object(c.jsx)("textarea",{style:{border:"none",outline:"none",flex:"1"},value:a,onChange:function(e){return s(e.target.value)},type:"submit",placeholder:"Type a message",autoFocus:!0}),Object(c.jsx)(T.a,{fontSize:"large",onClick:function(e){e.preventDefault(),""!==a&&E.collection("messages").doc(C).collection("messages").add({message:a,name:_,timestamp:W.a.firestore.FieldValue.serverTimestamp()},{merge:!0}).then((function(e){s(""),B(!z)})).catch((function(e){return console.log(e)}))},className:"form_button",type:"submit",style:{cursor:"pointer"}})]})})]})},B=(a(81),a(100));a(82);var G=function(){var e=Object(j.b)(),t=Object(n.useState)([""]),a=Object(r.a)(t,2),s=a[0],o=a[1];return Object(j.c)(x),Object(c.jsx)("div",{children:Object(c.jsx)("div",{className:"buttons",children:Object(c.jsx)(B.a,{className:"f6 grow no-underline br-pill ph3 pv2 mb2 dib white bg-black",disabled:!s,variant:"contained",color:"primary",type:"submit",onClick:function(t){t.preventDefault(),C.signInWithRedirect(U).then((function(t){e(O({userdetails:t.user.displayName,photourl:t.user.photoURL,email:t.user.email}))})).catch((function(e){return alert(e)})),o("")},children:"LogMeIn"})})})};var H=function(){var e=Object(j.c)(x),t=Object(j.b)();return Object(n.useEffect)((function(){C.onAuthStateChanged((function(e){e?(E.collection("rooms").doc(e.email).set({personName:e.email,timestamp:new Date,photoURL:e.photoURL,uid:e.uid},{merge:!0}).then().catch((function(e){console.log("Error in setting user, ",e)})),t(O({userdetails:e.displayName,photourl:e.photoURL,email:e.email,uid:e.uid}))):t(f())}))}),[]),Object(c.jsx)("div",{className:"App",children:e?Object(c.jsx)("div",{className:"app_body",children:Object(c.jsx)(h.a,{children:Object(c.jsxs)(h.b,{children:[Object(c.jsxs)(I.a,{path:"/rooms/:id",children:[Object(c.jsx)(L,{}),Object(c.jsx)(z,{})]}),Object(c.jsxs)(I.a,{exact:!0,path:"/chatbox",children:[Object(c.jsx)(L,{}),Object(c.jsx)(z,{})]}),Object(c.jsxs)(I.a,{exact:!0,path:"/",children:[Object(c.jsx)(L,{}),Object(c.jsx)(z,{})]})]})})}):Object(c.jsx)(G,{})})},K=Object(b.a)({reducer:{user:_}}),J=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function M(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}i.a.render(Object(c.jsx)(s.a.StrictMode,{children:Object(c.jsx)(j.a,{store:K,children:Object(c.jsx)(H,{})})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/chatbox",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/chatbox","/service-worker.js");J?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(a){var c=a.headers.get("content-type");404===a.status||null!=c&&-1===c.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):M(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):M(t,e)}))}}()}},[[84,1,2]]]);
//# sourceMappingURL=main.0175ac91.chunk.js.map